<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Midterm Project</title>
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
        <link rel='stylesheet prefetch' href='https://unpkg.com/bulma@0.7.4/css/bulma.min.css'>
        <link rel='stylesheet prefetch' href='https://use.fontawesome.com/releases/v5.0.10/css/all.css'>
        <link rel="stylesheet" href="tabs.css">
        <link href="style.css" rel="stylesheet" type="text/css">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="heatmap.js"></script>
  <script src="https://d3js.org/d3-color.v1.min.js"></script>
<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

    </head>
    <body>
        <nav class="navbar is-dark">
            <div class="navbar-brand">
                <a class="navbar-item" >
                    <img src="favicon.ico">
                </a>
                <div class="navbar-burger burger" data-target="navbarExampleTransparentExample">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div id="navbarExampleTransparentExample" class="navbar-menu">
                <div class="navbar-start is-link">
                    <a class="navbar-item" href="index.html">
                        Landing Page
                    </a>  
                </div>
        </nav>
        <section class="hero is-dark">
            <div class="hero-body">
                <div class="container">
                    <h1 class="title">
                    SF Fire Department Visualization: Lone Mountain/USF
                    </h1>
                    <h2 class="subtitle">
                    Team Tony and Friends
                    </h2>
                </div>
            </div>
            <div class="tabs is-boxed is-centered main-menu" id="nav">
                <ul>
                    <li data-target="pane-1" id="1" class="is-active">
                        <a>
                            <span class="icon is-small"><i class="fa fa-home"></i></span>
                            <span>Home</span>
                        </a>
                    </li>
                    <li data-target="pane-2" id="2">
                        <a>
                            <span class="icon is-small"><i class="fab fa-empire"></i></span>
                            <span>Data Processing Content</span>
                        </a>
                    </li>
                    <li data-target="pane-3" id="3">
                        <a>
                            <span class="icon is-small"><i class="fas fa-chart-bar"></i></span>
                            <span>Visualization 1</span>
                        </a>
                    </li>
                    <li data-target="pane-4" id="4">
                        <a>
                            <span class="icon is-small"><i class="fas fa-chart-bar"></i></span>
                            <span>Visualization 2</span>
                        </a>
                    </li>
                    <li data-target="pane-5" id="5">
                        <a>
                            <span class="icon is-small"><i class="fas fa-chart-bar"></i></span>
                            <span>Visualization 3</span>
                        </a>
                    </li>
                    <li data-target="pane-6" id="6">
                        <a>
                            <span class="icon is-small"><i class="fas fa-image"></i></span>
                            <span>Prototypes</span>
                        </a>
                    </li>
                    <li data-target="pane-7" id="7">
                        <a>
                            <span class="icon is-small"><i class="fas fa-info-circle"></i></span>
                            <span>About</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="tab-content">
                <div class="tab-pane is-active" id="pane-1" class="level">
                    <div class="content">
                        <h1>Project Theme</h1>
                            <p>
                                The Theme of our Project is to focus on the area of USF/Lone Mountain. 
                                We chose this specific area because we all go to school here and visualizing 
                                the data for this specific area will mean more to us than visualizing 
                                something that does not relate to us in any way. Hopefully by the end of 
                                this we will have 3 visualizations that all relate to USF and will show 
                                us something unique that none of us had already known. 
                        </p>
                    </div>
                </div>
                <div class="tab-pane" id="pane-3">
                    <div class="content">
                        <h3>John's Visualization</h3>
                            <svg id="tab1" width = "900" height="500"></svg>
                    </div>
                </div>
                <div class="tab-pane" id="pane-4">
                    <div class="tab-content">
                        <h3>Tony's Visualization</h3>
                            
                                <svg id="tab1" width = "900" height="500"></svg>
                            <p>
                              Hello
                              
                            </p>
                            <script>
                            /* helper method to make translating easier */
    var translate = function(x, y) {
      return "translate(" + x + "," + y + ")";
    };
    // container for configuration parameters
    var config = {};
    config.svg = {
      width: 960,
      height: 500
    };
    config.margin = {
      top: 50,
      right: 10,
      bottom: 20,
      left: 40
    };
    config.plot = {
      width: config.svg.width - config.margin.right - config.margin.left,
      height: config.svg.height - config.margin.top - config.margin.bottom
    };
    config.legend = {
      width: 200,
      height: 15
    };
    // create svg based on config
    var svg = d3.select("body").select("svg#tab1")
      .attr("width", config.svg.width)
      .attr("height", config.svg.height);
    // create plot area based on config
    var plot = svg.append("g")
      .attr("id", "plot")
      .attr("transform", translate(config.margin.left, config.margin.top));
    // create the scales and set ranges
    // https:github.com/d3/d3-scale/blob/master/README.md#scaleBand
    // we only need the plot dimensions for the range!
    // we will set the domain later when we load the data
    var xScale = d3.scaleBand()
      .range([0, config.plot.width]);
    var yScale = d3.scaleBand()
      .range([config.plot.height, 0], 0, 0);
    // create color scale for each cell
    // https://github.com/d3/d3-scale/blob/master/README.md#scaleSequential
    var colorScale = d3.scaleSequential(d3.interpolateYlOrRd);
    // formatter to parse dates
    // https://github.com/mbostock/d3/wiki/Time-Formatting
    // must match format used by csv
    // converts string to date
    var dateParse = d3.timeParse("%Y-%B");
    // used to nest data and output values nicely
    // converts date to string
    var yearFormat = d3.timeFormat("%Y");
    var monthFormat = d3.timeFormat("%B");
    // placeholder for data
    var data = [];
    var file = "Monthly_Property_Crime_2005_to_2015.csv";
    d3.csv(file, rowAccessor, dataCallback);
    function rowAccessor(d) {
      var row = {};
      row.date = dateParse(d["Date"]);
      row.year = yearFormat(row.date);
      row.month = monthFormat(row.date);
      //row.type = d["Category"];
      row.count = +d["IncidntNum"];
      return row;
    }
    function dataCallback(error, rows) { // callback
      if (error) {
        console.warn(error);
      }
      // we can use fancy d3 operations to group our data by year and month
      // https://github.com/d3/d3-collection/blob/master/README.md#nest
      data = d3.nest()
        .key(function(d) {
          return d.year;
        })
        // group by year first
        .key(function(d) {
          return d.month;
        })
        // group by month second
        .rollup(function(values) {
          // sum together all of the categories
          return d3.sum(values, function(d) {
            return d.count;
          })
        })
        .map(rows, d3.map); // return as nested d3.maps
      console.log("rows", rows);
      console.log("nest", data);
      // pull out years and months
      // use to set domain of x and y scales
      var years = data.keys();
      var months = data.get(years[0]).keys();
      xScale.domain(months);
      yScale.domain(years);
      /*
       * how will we map our values to those colors?
       * our first step is to calculate the min and max
       * the issue now is our sums are nested
       */
      // un-nesting these values is a little strange looking
      // debug each step in the console so you know what is going on
      // this returns all the values in our map
      // in this case, our values are themselves maps
      var values = data.values();
      // now we have an array of maps
      // grab the map values for each inner map
      values = values.map(function(d) {
        return d.values();
      });
      // now we have an array of arrays
      // merge arrays into a single array
      values = d3.merge(values);
      // now we can calculate the extent our counts
      var extent = d3.extent(values);
      /*
       * is this efficient?
       * goodness no! but if you cared, why are you doing
       * data processing in javascript!
       */
      // use these values as domain for our color scale
      colorScale.domain(extent);
      // finally, draw stuff
      drawBackground();
      drawAxes();
      drawHeatmap();
      drawTitle();
      drawLegend();
      
      d3.selectAll("rect").on("mouseover", function(d) {  d3.select(this).style("fill", "black"); })
      
       d3.selectAll("rect").on("mouseout", function(d) {  d3.select(this).style("fill", function(d){return colorScale(d.value)}); })
    }
    
    //d3.selectAll("rect").append("title").text("Hello");
</script>
<p> hello2 </p>

                    </div>
                </div>
                <div class="tab-pane" id="pane-5">
                    <div class="content">
                        <h3>Derrick's Visualization</h3>
                            <img src="DerrickDashboard.png">

                    </div>
                </div>
                <div class="tab-pane" id="pane-6">
                    <div class="content">
                        <h3>Prototypes</h3>
                        <h4>Prototype 1-John</h4>
                            <img src = "JohnPrototype.png">
                        <h4>Prototype 2-Tony</h4>
                            <img src="Sheet2.png">
                        <h4>Prototype 3-Derrick</h4>
                            <img src="DerrickDashboard.png">
                    </div>
                </div>
                <div class = "tab-pane" id="pane-7">
                    <div class ="content">
                        <h2 id="about">
        About Us
      </h2>

      <div class="media">
        <div class="media-left">
          <p class="image is-128x128">
            <!-- todo: replace with your profile image -->
            <img src="me.jpg" style="transform:rotate(90deg);">
          </p>
        </div>

        <div class="media-content">
            <p>
              <!-- todo: replace with your information -->
              <strong>Tony Jimenez</strong>
              <br/>
              Hello, my name is Tony Jimenez. I am a Junior in my 6th 
              semester here at the University of San Francisco. I am majoring in Computer Science and expect 
              to graduate in the Spring of 2020. Computers and Video Games are some of my 
              favorite things so one of my goals is to work in that field, but realistically, working in any field would be amazing as I am already doing something I love.
              <br/>
              <!-- find brand icons at: https://fontawesome.com/icons?d=gallery&s=brands&m=free -->
              &bullet;<a href="https://github.com/Tjimenez3">
                <span class="fab fa-github"></span>
                <span>Github</span>
              </a>
              <br><b>Contact Info:</b>
                <br>&bullet;Email:  <a href="tjimenez3@dons.usfca.edu">tjimenez3@dons.usfca.edu 
                </a> 
            </p>

        </div>
      </div>

      <div class="media">
        <div class="media-left">
          <p class="image is-128x128">
            <!-- todo: replace with your profile image -->
            <img src="me2.jpg" >
          </p>
        </div>

        <div class="media-content">
            <p>
              <!-- todo: replace with your information -->
              <strong>John Murray</strong>
              <br/>
              Hi, my name is John Murray, and I am a senior at the University of San Francisco studying Computer Science. I plan on graduating in Spring of 2019. I am a huge Bay Area sports fan, avid coffee lover, and gym enthusiast. I’m hoping to pursue a Master’s Degree from the University of San Francisco as well. 
              <br/>
              <!-- find brand icons at: https://fontawesome.com/icons?d=gallery&s=brands&m=free -->
              &bullet;<a href="https://github.com/johnrmurray">
                <span class="fab fa-github"></span>
                <span>Github</span>
              </a>
              <a href="https://www.linkedin.com/in/john-murray-61b576178/">
                <span class="fab fa-linkedin"></span>
                <span>LinkedIn</span>
              </a>
              <br><b>Contact Info:</b>
                <br>&bullet;Email:  
                <a href="mailto:jrmurray2@dons.usfca.edu">jrmurray2@dons.usfca.edu 
                </a> 
            </p>

        </div>
      </div>
      <div class="media">
        <div class="media-left">
          <p class="image is-128x128">
            <!-- todo: replace with your profile image -->
            <img src="https://scontent-sjc3-1.xx.fbcdn.net/v/t1.0-9/28467645_1544087655640651_3662163967019089818_n.jpg?_nc_cat=103&_nc_ht=scontent-sjc3-1.xx&oh=5f01aa3e77094a9a623c8a05fce0cb45&oe=5CF0D231">
          </p>
        </div>

        <div class="media-content">
            <p>
              <!-- todo: replace with your information -->
              <strong>Derrick Shiu</strong>
              <br/>
              My name is Derrick Shiu, and I'm currently a senior Computer Science Major at USF, where I plan to graduate in Spring of 2019. I am a certified lifeguard, and I help my family with the West Coast Lion Dance Troupe, a Chinese lion dance group based out of Daly City. Video games are one of my favorite hobbies, and I'd love to find my way into that field after graduating.
              <br/>
              <!-- find brand icons at: https://fontawesome.com/icons?d=gallery&s=brands&m=free -->
              &bullet;<a href="https://github.com/dashiu/">
                <span class="fab fa-github"></span>
                <span>Github</span>
              </a>
              &bullet;
              <a href="https://www.linkedin.com/in/derrick-shiu-663748171/">
                <span class="fab fa-linkedin"></span>
                <span>LinkedIn</span>
              </a>
              <br><b>Contact Info:</b>
                <br>&bullet;Email:
                <a href="mailto:dashiu@dons.usfca.edu">dashiu@dons.usfca.edu 
                </a>  
            </p>

        </div>
      </div>

                    </div>
                </div>
                <div class="tab-pane" id="pane-2">
                    <div class="content">
                        <h1>Data Set</h1>
                        <p>This data set is attributed to Open Data and DataSF. 
                            The original link can for the data set can be found 
                            <a href= "https://data.sfgov.org/Public-Safety/Fire-Department-Calls-for-Service/nuek-vuh3" style="color: rgb(0,0,255)">here</a>
                        </p>
                        <p> The original data set has 4,886,219 Rows and 34 Columns. It is data all about Fire Department Calls for Service. The website says that there may be multiple records for each call numbers since this logs the responses. This could mean that both a Fire Engine and an Ambulance could have been dispached to the scene and would then record 2 responses in the data set. An example of the type of data it contains is 'Call Type' which would tell you what the incident was or 'Neighborhood' which would tell you which neighborhood this happened in.
                        </p>
                        <h1>Draft Data Processing</h1>
                        <p> The original Data set was obviously way to large so we had to filter out some things and focus on some others. We decided that we want to focus our project on Fires in the Lone Mountain/USF area. We kept in all 34 Columns just in case we would want to add something later on with columns. We did however lower the amount of Rows in our Data Set. We filtered the data on the sfgov website. We filtered from over 4 million Rows to a manageable 4,326. If this proves to be too much data we might lower our bounds and filter it even more. We filtered by date and chose a 10 year range from 2009 to 2018. We also filtered it to only include the Lone Mountain/USF neighborhood. Finally we decided that we only wanted to include Outside Fires and Structure Fires. This would fit into our general theme of looking at fires over the years in the USF area.

                </div>
            </div>
        </div>
    </section>
    <!-- footer -->
  <footer class="footer">
    <div class="content has-text-centered">
      <small>
        <a href="#top">
          <span class="fas fa-arrow-up"></span>
          <span>Back to Top</span>
        </a>
        <br/>
        <a href="https://usf-cs360-spring2019.github.io/index.html">CS 360/560 Data Visualization</a>
        &bullet;
        <a href="https://myusf.usfca.edu/arts-sciences/computer-science">Department of Computer Science</a>
        &bullet;
        <a href="https://www.usfca.edu/">University of San Franciscio</a>
      </small>
    </div>
  </footer>

    <script src="bulma.js"></script>
    <script src="tabs.js"></script>
</body>
</html>